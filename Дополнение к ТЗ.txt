–ù–∏–∂–µ –æ—Ç–≤–µ—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É –±–ª–æ–∫—É + —á—Ç–æ —Å—Ç–æ–∏—Ç –∑–∞—Ä–∞–Ω–µ–µ —Ä–µ—à–∏—Ç—å/–∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å.
---
## 1. –ß—Ç–æ –Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å –ø–æ –ø—Ä–æ–µ–∫—Ç—É
–†–µ–∫–æ–º–µ–Ω–¥—É—é —è–≤–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å:
1) –Ø–∑—ã–∫ –∏ –ª–æ–∫–∞–ª—å
- –¢–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–∏–π
2) –¢–µ–º—ã –∏ –ø–æ–¥–±–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤
- –ï—Å—Ç—å ‚Äú–°–º–µ—à–∞–Ω–Ω–∞—è —Ç–µ–º–∞‚Äù (—Ä–∞–Ω–¥–æ–º –ø–æ –≤—Å–µ–º)?
- –ú–æ–∂–Ω–æ –∏–≥—Ä–æ–∫—É –≤—ã–±–∏—Ä–∞—Ç—å —Ç–µ–º—É –≤ –±—ã—Å—Ç—Ä–æ–π –∏–≥—Ä–µ –∏
–ª–∏ –∏–≥—Ä–∞—Ç—å —Ä–∞–Ω–¥–æ–º
3) –õ–∏–º–∏—Ç—ã
- –ú–∞–∫—Å–∏–º—É–º –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–Ω–µ –±–æ–ª–µ–µ 500).
- –ú–∞–∫—Å–∏–º—É–º –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –±–∞–∑–µ (–Ω–µ –±–æ–ª–µ–µ 50 000?–Ω–µ –∑–Ω–∞—é –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ).
4) –î–µ–Ω–µ–∂–Ω–∞—è –º–æ–¥–µ–ª—å (–Ω–∞ –±—É–¥—É—â–µ–µ)
- –ï—Å—Ç—å –ø–ª–∞–Ω—ã –Ω–∞ –¥–æ–Ω–∞—Ç/–ø—Ä–µ–º–∏—É–º (–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º—ã, —Å–ø–µ—Ü-—Ä–µ–∂–∏–º—ã, —Å–∫–∏–Ω—ã –∏ —Ç.–ø.).
–°–µ–π—á–∞—Å –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–æ–∂–∏—Ç—å –ø–æ–ª—è is_premium –∏ —Ç.–ø. –≤ users.
---
## 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è / —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
-- –ö–∞–∫ —Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ –≤ users –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
–ú–æ–¥–µ–ª—å: –ª–µ–Ω–∏–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ Telegram-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É.
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–º—ë—Ç /start.
2. –•—ç–Ω–¥–ª–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç from.id, username, first_name, last_name.
3. –ê–ª–≥–æ—Ä–∏—Ç–º:
on_start(update):
tg_id = update.from.id
username = update.from.username
full_name = combine(update.from.first_name, update.from.last_name)
user = SELECT * FROM users WHERE telegram_id = tg_id
if user == null:
INSERT INTO users (
telegram_id,
username,
full_name,
is_bot,
created_at,
updated_at
) VALUES (
tg_id,
username,
full_name,
false,
now(),
now()
)
else:
-- –æ–±–Ω–æ–≤–ª—è–µ–º username/full_name –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —É —á–µ–ª–æ–≤–µ–∫–∞ –æ–Ω–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å
UPDATE users
SET username = username,
full_name = full_name,
updated_at = now()
WHERE telegram_id = tg_id
4. –ù–∏–∫–∞–∫–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è ‚Äî –≤—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram.
5. –î–ª—è –±–æ—Ç–æ–≤ –≤ users:
- telegram_id = NULL,
- is_bot = TRUE,
- —Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ —Å–∫—Ä–∏–ø—Ç–æ–º –∏–ª–∏ –∞–¥–º–∏–Ω–∫–æ–π.
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏).
- –ü—Ä–æ–¥—É–º–∞—Ç—å, —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ username –ø—É—Å—Ç–æ–π (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å full_name –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è).
---
## 3. –†–µ–π—Ç–∏–Ω–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
–û–Ω–∞ —É–∂–µ —É–ø–æ–º—è–Ω—É—Ç–∞ (üìä –†–ï–ô–¢–ò–ù–ì + –ø–æ–ª–µ rating –≤ users), –Ω–æ –Ω—É–∂–Ω–æ —á—ë—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å:
-- 3.1. –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:
- rating ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–∞.
- games_played ‚Äî –≤—Å–µ–≥–æ —Å—ã–≥—Ä–∞–Ω–æ –∏–≥—Ä.
- games_won ‚Äî –ø–æ–±–µ–¥.
–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
- avg_place ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –º–µ—Å—Ç–æ –≤ –∏–≥—Ä–∞—Ö.
- correct_answers_total ‚Äî –≤—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.
- fastest_answer_time ‚Äî –ª—É—á—à–∏–π (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π) –æ—Ç–≤–µ—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–¥–ª—è –∞—á–∏–≤–æ–∫).
-- 3.2. –ö–∞–∫ —Å—á–∏—Ç–∞—Ç—å rating
–û–¥–∏–Ω –∏–∑ —Ä–∞–±–æ—á–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–ø—Ä–æ—Å—Ç–æ–π Elo-like):
1. –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–Ω—Ü–∏–ø:
- –ü–æ–±–µ–¥–∞ –≤ –∏–≥—Ä–µ = +K –æ—á–∫–æ–≤.
- –ú–µ—Å—Ç–∞ 2‚Äì3 = +–º–µ–Ω—å—à–µ.
- –û—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî –Ω–µ–º–Ω–æ–≥–æ, 0 –∏–ª–∏ –º–∏–Ω—É—Å.
2. –ü—Ä–æ—Å—Ç–æ–π –ª–∏–Ω–µ–π–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:
–ù–∞–ø—Ä–∏–º–µ—Ä, –∏–≥—Ä–∞ –Ω–∞ 10 —á–µ–ª–æ–≤–µ–∫:
- 1 –º–µ—Å—Ç–æ: +20
- 2 –º–µ—Å—Ç–æ: +12
- 3 –º–µ—Å—Ç–æ: +8
- 4‚Äì5: +4
- 6‚Äì8: 0
- 9‚Äì10: ‚àí4
–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –∏–≥—Ä—ã –º–æ–∂–Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ (–∏–ª–∏ –¥–∞–≤–∞—Ç—å —Å–∏–ª—å–Ω–æ –º–µ–Ω—å—à–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç).
–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º—É–ª—ã:
on_game_finished(game_id):
players = SELECT user_id, final_place
FROM game_players
WHERE game_id = game_id AND is_bot = FALSE
for p in players:
delta = calc_delta_by_place(p.final_place, N_players)
UPDATE users
SET rating = rating + delta,
games_played = games_played + 1,
games_won = games_won + (p.final_place == 1 ? 1 : 0)
WHERE id = p.user_id
–§—É–Ω–∫—Ü–∏—è calc_delta_by_place:
if training_game:
return 0
if place == 1: return +20
if place == 2: return +12
if place == 3: return +8
if place in (4, 5): return +4
if place in (6, 7, 8): return 0
else: return -4
–ú–æ–∂–Ω–æ —É—Å–ª–æ–∂–Ω–∏—Ç—å (—É—á–∏—Ç—ã–≤–∞—Ç—å —Å–∏–ª—É —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤, –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∑–æ–Ω–æ–≤ –∏ —Ç.–ø.), –Ω–æ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.
-- 3.3. –≠–∫—Ä–∞–Ω ¬´–†–µ–π—Ç–∏–Ω–≥¬ª
–†–∞–∑–¥–µ–ª–∏—Ç—å:
1. –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥:
- –¢–æ–ø-100 –∏–≥—Ä–æ–∫–æ–≤ –ø–æ rating (–±–µ–∑ –±–æ—Ç–æ–≤).
ChatGPT & DeepSeek ‚ô•Ô∏è, [17.01.2026 16:56]
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ: –º–µ—Å—Ç–æ, –Ω–∏–∫, —Ä–µ–π—Ç–∏–Ω–≥, —Å—ã–≥—Ä–∞–Ω–æ, –ø–æ–±–µ–¥.
2. *–õ–∏—á–Ω—ã–π –±–ª–æ–∫ –∏–≥—Ä–æ–∫–∞* (–≤–≤–µ—Ä—Ö—É –∏–ª–∏ –ø–æ –∫–Ω–æ–ø–∫–µ ¬´–ú–æ–π —Ä–µ–π—Ç–∏–Ω–≥¬ª):
- –¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥.
- –ú–µ—Å—Ç–æ –≤ –º–∏—Ä–µ (–ø–æ–∑–∏—Ü–∏—è: —Å–∫–æ–ª—å–∫–æ –ª—é–¥–µ–π –≤—ã—à–µ).
- –°—ã–≥—Ä–∞–Ω–æ –∏–≥—Ä / –ø–æ–±–µ–¥ / –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥.
---
## 4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —á—Ç–æ –∏ –∫–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
*--* 4.1. –õ–∏—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
–ö–æ–º–∞–Ω–¥–∞/–∫–Ω–æ–ø–∫–∞ `üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞`:
–ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
- –û–±—â–∏–µ:
- –°—ã–≥—Ä–∞–Ω–æ –∏–≥—Ä: `games_played`.
- –ü–æ–±–µ–¥: `games_won`.
- –ü–æ–±–µ–¥ % = `games_won / games_played * 100%`.
- –¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥.
- –í–æ–ø—Ä–æ—Å—ã:
- –í—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (—á–µ—Ä–µ–∑ –∞–≥—Ä–µ–≥–∞—Ç –ø–æ `answers`, –º–æ–∂–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å).
- –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö.
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (–ø–æ –≤—Å–µ–º –æ—Ç–≤–µ—Ç–∞–º, –≥–¥–µ `selected_option` –Ω–µ NULL).
- –†–µ–∫–æ—Ä–¥—ã:
- –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–¥–Ω–æ–π –∏–≥—Ä–µ (–º–∞–∫—Å. `total_score` –≤ `game_players`).
- –†–µ–∫–æ—Ä–¥ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–Ω—ã–º –æ—Ç–≤–µ—Ç–∞–º (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π `answer_time`).
–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —É–ø—Ä–æ—â—ë–Ω–Ω–æ, –∞ —á—Ç–æ —Ç—è–∂–µ–ª–æ–µ –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º ‚Äî –ø—Ä–µ–¥—Ä–∞—Å—á–∏—Ç—ã–≤–∞—Ç—å (cron‚Äô–æ–º –∏–ª–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∏–≥—Ä—ã).
*--* 4.2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–≥—Ä–µ (–ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã)
–ü–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª–∞:
- –¢–∞–±–ª–∏—Ü–∞ –º–µ—Å—Ç:
- –ú–µ—Å—Ç–æ, –Ω–∏–∫, —Å—É–º–º–∞—Ä–Ω—ã–π —Å—á—ë—Ç, —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è.
- –ö–Ω–æ–ø–∫–∞ ‚Äú–î–µ—Ç–∞–ª–∏ –∏–≥—Ä—ã‚Äù:
- –°–≤–æ–¥–∫–∞ –ø–æ —Ä–∞—É–Ω–¥–∞–º (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞—É–Ω–¥–∞: —Å–∫–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —É –∏–≥—Ä–æ–∫–∞, –∫—Ç–æ –≤—ã–±—ã–ª).
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–±–æ—Ä: ‚Äú–≤–æ–ø—Ä–æ—Å—ã, –≥–¥–µ —Ç—ã –æ—à–∏–±—Å—è‚Äù.
*--* 4.3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–∞—É–Ω–¥—É (—Ç–æ, —á—Ç–æ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å)
–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–∞—É–Ω–¥–∞:
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –µ—â—ë –∂–∏–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤:
- –∏–º—è, `–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ/10`, `(—Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è)` –≤ —Ä–∞—É–Ω–¥–µ.
- –û—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫:
- ‚Äú–†–∞–≤–µ–Ω—Å—Ç–≤–æ –æ—á–∫–æ–≤!‚Äù +
- ‚Äú–ú–µ–¥–ª–µ–Ω–Ω–µ–µ –æ—Ç–≤–µ—á–∞–ª: X‚Äù +
- ‚Äú–í—ã–±—ã–≤–∞–µ—Ç: X‚Äù.
---
## 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–ù—É–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è —Ç—Ä—ë—Ö —É—Ä–æ–≤–Ω–µ–π: Telegram API, –ë–î, –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á.
*--* 5.1. –°–±–æ–∏ Telegram API
–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã: —Ç–∞–π–º–∞—É—Ç—ã, rate limit, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞–¥–µ–Ω–∏—è.
–°—Ç—Ä–∞—Ç–µ–≥–∏—è:
1. *–†–µ—Ç—Ä–∞–π —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ø–∞—É–∑–æ–π* (1s ‚Üí 2s ‚Üí 4s ‚Üí 8s, –¥–æ N –ø–æ–ø—ã—Ç–æ–∫).
2. –ï—Å–ª–∏ –ø–æ—Å–ª–µ N –ø–æ–ø—ã—Ç–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å:
- –ª–æ–≥–∏—Ä—É–µ—à—å –æ—à–∏–±–∫—É,
- –ø–æ–º–µ—á–∞–µ—à—å –∑–∞–¥–∞—á—É –∫–∞–∫ –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—É—é,
- –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ –ª–æ–º–∞–π –∏–≥—Ä—É (–∏–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –Ω–µ –ø–æ–ª—É—á–∏—Ç—å –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ).
3. –ù–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—á–∞—Å—Ç–∫–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞):
- –µ—Å–ª–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ ‚Üí –º–æ–∂–Ω–æ:
- –ª–∏–±–æ –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–∞—É–Ω–¥/–∏–≥—Ä—É –∏ —Ä–∞–∑–æ—Å–ª–∞—Ç—å ‚Äú–∏–≥—Ä–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞‚Äù –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏,
- –ª–∏–±–æ –≤—Å—ë-—Ç–∞–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –Ω–æ —ç—Ç–æ —É—Ö—É–¥—à–∞–µ—Ç UX.
–ú–∏–Ω–∏–º—É–º:
‚Äì –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –ø–æ –æ—Ç–ø—Ä–∞–≤–∫–µ;
‚Äì —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ¬´–æ—à–∏–±–æ—á–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è¬ª (–¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏).
*--* 5.2. –°–±–æ–∏ –ë–î
–ï—Å–ª–∏ –ë–î –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:
1. –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –≤ try/except (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥) —Å:
- –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º,
- –ø–æ–ø—ã—Ç–∫–æ–π —Ä–µ—Ç—Ä–∞—è (1‚Äì3 —Ä–∞–∑–∞, —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π).
2. –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å:
- –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —á—Ç–µ–Ω–∏—è: –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–∏–¥–∞
‚Äú–°–µ–π—á–∞—Å —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–ø—Ä–æ–±—É–π —á–µ—Ä–µ–∑ –ø–∞—Ä—É –º–∏–Ω—É—Ç.‚Äù
- –¥–ª—è –∏–≥—Ä—ã (–∫–æ–≥–¥–∞ –∏–¥—ë—Ç —Ä–∞—É–Ω–¥):
- –º–æ–∂–Ω–æ –ø—Ä–æ–±–æ–≤–∞—Ç—å *–ø–æ—Å—Ç–∞–≤–∏—Ç—å –∏–≥—Ä—É –Ω–∞ –ø–∞—É–∑—É*: —Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î —Å—Ç–∞—Ç—É—Å ‚Äúerror_pause‚Äù.
- –Ω–æ –µ—Å–ª–∏ –ë–î —Å–æ–≤—Å–µ–º –ª–µ–∂–∏—Ç, —Ç—ã —ç—Ç–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –∑–∞–ø–∏—à–µ—à—å.
–ü–æ—ç—Ç–æ–º—É –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –Ω—É–∂–Ω–æ —É–º–µ—Ç—å:
- –ø–æ –∑–∞–¥–∞—á–µ –≤ Celery/–ª–æ–≥–∞–º –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –∏–≥—Ä—ã –±—ã–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã,
- –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏—Ö –≤ —Å—Ç–∞—Ç—É—Å `cancelled` –∏ —É–≤–µ–¥–æ–º–∏—Ç—å –∏–≥—Ä–æ–∫–æ–≤.
*--* 5.3. –°–±–æ–∏ –∑–∞–¥–∞—á Celery / –æ—á–µ—Ä–µ–¥–∏
1. –í—Å–µ –≤–∞–∂–Ω—ã–µ —Ç–∞—Å–∫–∏ (—Å—Ç–∞—Ä—Ç —Ä–∞—É–Ω–¥–∞, –ø–æ–¥—Å—á—ë—Ç –∏—Ç–æ–≥–æ–≤, –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ) –¥–æ–ª–∂–Ω—ã:
- –±—ã—Ç—å *–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏* (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ –ª–æ–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ),
- –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç—É—Å –∏–≥—Ä—ã/—Ä–∞—É–Ω–¥–∞ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏.
2. –ï—Å–ª–∏ Celery –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:
- –Ω–æ–≤—ã–µ –∏–≥—Ä—ã –Ω–µ –±—É–¥—É—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏,
- —Ç–∞–π–º–µ—Ä—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—é—Ç.
3. –ù—É–∂–Ω–æ:
- –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ Celery (healthcheck),
- —É–≤–µ–¥–æ–º–ª—è—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞/–∞–¥–º–∏–Ω–∞ –ø—Ä–∏ –ø—Ä–æ—Å—Ç–æ–µ,
- –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ä—É—á–Ω—É—é ‚Äú–¥–æ–¥–µ–ª–∞—Ç—å‚Äù —à–∞–≥–∏ (–∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥–∞ —Ç–∏–ø–∞ `/force_finish_round game_id round_num`).
–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:
‚Äì –í –ª–æ–≥–∞—Ö –∏–º–µ—Ç—å —á—ë—Ç–∫–∏–π trace: `game_id`, `round_id`, `round_question_id`, `task_name`, `status`.
‚Äì –í –ë–î ‚Äì –ø–æ–ª–µ `last_error`/`last_error_at` –¥–ª—è `games`/`rounds` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
---
## 6. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
*--* 6.1. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∏–≥—Ä
–ù—É–∂–Ω–æ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ —Ä–µ—à–∏—Ç—å:
- –ï—Å—Ç—å –ª–∏ *–∂—ë—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç* –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä?
–ù–∞–ø—Ä–∏–º–µ—Ä:
- 500 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–≥—Ä,
- 1000,
ChatGPT & DeepSeek ‚ô•Ô∏è, [17.01.2026 16:56]
- –±–µ–∑ –ª–∏–º–∏—Ç–∞ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∂–µ–ª–µ–∑–æ–º).
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –Ω–∞ —Å—Ç–∞—Ä—Ç–µ:
- –í–≤–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä MAX_ACTIVE_GAMES (–Ω–∞–ø—Ä–∏–º–µ—Ä, 500).
- –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π –∏–≥—Ä—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å:
SELECT COUNT(*) FROM games WHERE status IN ('pre_start', 'in_progress');
–ï—Å–ª–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ä–æ–≥:
- –í –±—ã—Å—Ç—Ä–æ–π –∏–≥—Ä–µ ‚Äî –ø–∏—Å–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ‚Äú–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.‚Äù
- –í –ø—Ä–∏–≤–∞—Ç–Ω–æ–π ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏–ª–∏ —Å—Ç–∞–≤–∏—Ç—å –≤ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç.
-- 6.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
1. –û–¥–∏–Ω PostgreSQL –Ω–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ü–æ—Ç–æ–º:
- —Ä–µ–ø–ª–∏–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è (—Ä–µ–ø–æ—Ä—Ç–∏–Ω–≥, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞),
- –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äì —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ game_id –∏–ª–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏.
2. Backend (–±–æ—Ç) –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ:
- –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –±–æ—Ç–∞ –∑–∞ load balancer‚Äô–æ–º,
- –µ–¥–∏–Ω–∞—è –ë–î –∏ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á.
3. Celery-–≤–æ—Ä–∫–µ—Ä—ã:
- –æ—Ç–¥–µ–ª—å–Ω—ã–µ worker-–ø—É–ª—ã –ø–æ —Ç–∏–ø–∞–º –∑–∞–¥–∞—á:
- –±—ã—Å—Ç—Ä—ã–µ (–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤),
- —Ç—è–∂—ë–ª—ã–µ (–ø–æ–¥–±–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞).
4. –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
- —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã —Ü–µ–ª–∏–∫–æ–º –≤ –ë–î (–±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –≤ –ø–∞–º—è—Ç–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞),
- —á—Ç–æ–±—ã –ª—é–±–æ–π –≤–æ—Ä–∫–µ—Ä –º–æ–≥ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É.
---
## 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ù—É–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å:
-- 7.1. –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤
1. –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (core-–ª–æ–≥–∏–∫–∞, –±–µ–∑ Telegram/–ë–î):
- –≤—ã–±–æ—Ä –≤—ã–±—ã–≤–∞—é—â–µ–≥–æ –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ –æ—á–∫–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏;
- —Ä–∞—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ –º–µ—Å—Ç–∞–º;
- –≤—ã–±–æ—Ä –≤–æ–ø—Ä–æ—Å–∞ (—É—á—ë—Ç game_used_questions, user_questions_history);
- –ª–æ–≥–∏–∫–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (–≤—Å–µ ‚Äú–∂–¥—É—Ç‚Äù vs –∫—Ç–æ-—Ç–æ ‚Äú–Ω–∞—á–∞—Ç—å‚Äù).
2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:
- —Å —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î:
- —Å–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—ã, —Ä–∞—É–Ω–¥–æ–≤, –≤–æ–ø—Ä–æ—Å–æ–≤;
- –ø–æ–ª–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ 1 –∏–≥—Ä—ã (1‚Äì2 —Ä–∞—É–Ω–¥–∞ –º–∏–Ω–∏–º—É–º).
- —Å –º–æ–∫–∞–º–∏ Telegram API:
- –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ inline-–∫–Ω–æ–ø–æ–∫.
3. End-to-End (E2E) / —Å—Ü–µ–Ω–∞—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã:
- —Å –ø–æ–¥–Ω—è—Ç—ã–º —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º:
- —Å–∏–º—É–ª—è—Ü–∏—è 10 –∏–≥—Ä–æ–∫–æ–≤ (—Å–∫—Ä–∏–ø—Ç–æ–º) ‚Üí –∑–∞–ø—É—Å–∫ –±—ã—Å—Ç—Ä–æ–π –∏–≥—Ä—ã ‚Üí –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ö–æ—Ç—è –±—ã 1‚Äì2 —Ä–∞—É–Ω–¥–æ–≤;
- —Å—Ü–µ–Ω–∞—Ä–∏–π —Å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ–º (3‚Äì9 –∏–≥—Ä–æ–∫–æ–≤, –≤—Å–µ –∂–º—É—Ç ‚Äú–ñ–î–ê–¢–¨‚Äù, –∫—Ç–æ-—Ç–æ –∂–º—ë—Ç ‚Äú–ù–ê–ß–ê–¢–¨‚Äù).
4. –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã (–ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞):
- –∏–º–∏—Ç–∞—Ü–∏—è N –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–≥—Ä, M –∏–≥—Ä–æ–∫–æ–≤,
- —Å–º–æ—Ç—Ä–∏–º –∑–∞–¥–µ—Ä–∂–∫–∏, –æ—à–∏–±–∫–∏, –ø–æ–≤–µ–¥–µ–Ω–∏–µ Celery.
-- 7.2. –ü–æ–∫—Ä—ã—Ç–∏–µ
–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ü–µ–ª–∏:
- –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç–∞–º–∏ –ø–æ–∫—Ä—ã—Ç—å:
- ‚â• 80% –∫—Ä–∏—Ç–∏—á–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–∏–≥—Ä–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞, —Ä–µ–π—Ç–∏–Ω–≥, –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ).
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏:
- –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
- –±—ã—Å—Ç—Ä–∞—è –∏–≥—Ä–∞,
- —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞,
- –ø—Ä–∏–≤–∞—Ç–Ω–∞—è –∏–≥—Ä–∞ (2‚Äì3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è),
- –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ä—Ç,
- –≤—ã–±—ã–≤–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ.
- E2E:
- —Ö–æ—Ç—è –±—ã 2‚Äì3 –ø–æ–ª–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è:
- ‚Äú10 –ª—é–¥–µ–π ‚Üí –±—ã—Å—Ç—Ä–∞—è –∏–≥—Ä–∞ –¥–æ —Ñ–∏–Ω–∞–ª–∞‚Äù (—Å —Å–∏–º—É–ª—è—Ü–∏–µ–π –æ—Ç–≤–µ—Ç–æ–≤),
- ‚Äú–º–∞–ª–æ –ª—é–¥–µ–π ‚Üí –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏‚Äù,
- ‚Äú–≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ: –≤—Å–µ –∂–º—É—Ç –∂–¥–∞—Ç—å‚Äù.
–î–ª—è –Ω–∞—á–∞–ª–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ —Ç—è–∂—ë–ª—ã—Ö –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, –Ω–æ —Ç–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥, —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –¥–æ–±–∞–≤–∏—Ç—å.
---
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –¥–∞–ª—å—à–µ –º–æ–∂–Ω–æ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –æ–¥–Ω–æ–º –∏–∑ –±–ª–æ–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏–ª–∏ –ø–æ–ª–Ω–æ–π E2E-—Å–µ—Å—Å–∏–∏ –∏–≥—Ä—ã –æ—Ç –≤—Ö–æ–¥–∞ –≤ –ø—É–ª –¥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è). –•–æ—Ç–µ–ª –±—ã —Å–Ω–∞—á–∞–ª–∞ –¥–æ–±–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ (A) –∏–ª–∏ —Å—Ü–µ–Ω–∞—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã (B)?
