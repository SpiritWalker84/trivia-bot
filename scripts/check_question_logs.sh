#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–æ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤

LOG_FILE="logs/celery_worker.log"

if [ ! -f "$LOG_FILE" ]; then
    echo "‚ùå –§–∞–π–ª –ª–æ–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω: $LOG_FILE"
    echo "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ Celery worker –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ª–∏ –æ–Ω –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —ç—Ç–æ—Ç —Ñ–∞–π–ª."
    exit 1
fi

echo "=========================================="
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤"
echo "=========================================="
echo "–§–∞–π–ª: $LOG_FILE"
echo ""

echo "üìä –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ –≤–æ–ø—Ä–æ—Å–∞—Ö (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50):"
echo "----------------------------------------"
grep -i "send_next_question\|send_question_to_players\|Question.*sent" "$LOG_FILE" | tail -n 50
echo ""

echo "‚ö†Ô∏è  –û—à–∏–±–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30):"
echo "----------------------------------------"
grep -i "SEQUENCE ERROR\|was already displayed\|skipping.*question" "$LOG_FILE" | tail -n 30
echo ""

echo "üîç –í—Å–µ –≤—ã–∑–æ–≤—ã send_next_question (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50):"
echo "----------------------------------------"
grep -i "send_next_question CALLED\|Scheduling next question" "$LOG_FILE" | tail -n 50
echo ""

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –î–ª—è –∂–∏–≤–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: tail -f $LOG_FILE"
